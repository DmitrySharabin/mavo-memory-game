<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="author" content="Dmitry Sharabin" />
	<meta name="description" content="Udacity. Front-End Web Developer Nanodegree Program. Project #2" />
	<meta name="keywords" content="HTML,CSS,Udacity,Nanodegree,Mavo" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />

	<!-- Mavo -->
	<link rel="stylesheet prefetch" href="https://get.mavo.io/mavo.css">
	<script src="https://get.mavo.io/mavo.js"></script>

	<link rel="stylesheet prefetch" href="css/style.css">
	<title>Memory Game</title>
</head>
<body>
	<header mv-app>
		<h1>Memory Game</h1>
		<h2 class="game-theme">
			theme ‚Äú<span mv-value="get(game.gameTheme, 'name')">emoji</span>‚Äù
		</h2>
	</header>

	<main>
		<!-- Statistics Panel -->
		<section class="statistics" mv-app>
			<!-- Star Rating -->
			<span class="star-rating">
				<svg id="star-1" class="star [if(game.rating > 0, full)]">
					<use xlink:href="#icon-star" />
				</svg>
				<svg id="star-2" class="star [if(game.rating > 1, full)]">
					<use xlink:href="#icon-star" />
				</svg>
				<svg id="star-3" class="star [if(game.rating > 2, full)]">
					<use xlink:href="#icon-star" />
				</svg>
			</span>

			<!-- Moves counter -->
			<span class="moves-counter" mv-value="[pluralize(game.move, 'move', 'moves')]">0 moves</span>

			<!-- Timer -->
			<span class="timer" mv-value="if(game.gameStarted = true, game.timer, '00:00')">00:00</span>

			<!-- Reset Game button -->
			<svg class="reset-button"
				mv-action="
					set(get(game.card, 'state'), initial)
					set(game.themeNumber, random(0, count(game.theme) - 1))
					set(game.move, 0)
					set(game.gameStarted, false)
				">
				<title>Reset Game</title>
				<use xlink:href="#icon-reset" />
			</svg>
		</section>

		<section mv-app="game" mv-mode="read" mv-bar="none">
			<!-- Themes -->
			<meta property="theme"
				content="[group(name: animals, symbols: list('üê∂', 'üê±', 'üê≠', 'üêπ', 'üêª', 'üêº', 'üêµ', 'üêØ'), color: '60b3f1')]" mv-group />
			<meta property="theme"
				content="[group(name: emoji, symbols: list('üòá', 'üòç', 'üòÇ', 'üòé', 'üòò', 'üò±', 'üò≥', 'üòâ'), color: 'ee7622')]" mv-group />
			<meta property="theme"
				content="[group(name: flora, symbols: list('üåµ', 'üå≤', 'üå¥', 'üåø', 'üçÅ', 'üå∑', 'üå∫', 'üåæ'), color: '4dc774')]" mv-group />

			<!-- Settings -->
			<meta property="themeNumber" content="[random(0, count(theme) - 1)]" />
			<meta property="gameTheme" content="[get(theme, themeNumber)]" />
			<meta property="symbols" content="[get(gameTheme, 'symbols')]" />
			<meta property="color" content="[get(gameTheme, 'color')]" />

			<!-- Game state -->
			<meta property="move" content="0" />
			<meta property="rating" content="[if(move < 19, 3, if(move < 26, 2, if(move < 32, 1, 0)))]" />
			<meta property="gameStarted" />
			<meta property="startTime" mv-default="[$now]" />

			<meta property="minutes" content="[minutes($now - startTime) mod 60]" />
			<meta property="seconds" content="[seconds($now - startTime) mod 60]" />
			<meta property="timer" content="[if(minutes < 10, 0 & minutes, minutes)]:[if(seconds < 10, 0 & seconds, seconds)]" />

			<meta property="gameOver" content="[count(card where state = matched) = count(card)]" />

			<meta property="firstCard" content="‚ò†Ô∏è" />

			<ul id="game-board" mv-list mv-value="shuffle(list(symbols, symbols))" style="--theme-color: #[color]">
				<li mv-list-item class="card [state]"
					mv-action="
						if(move = 0, set(gameStarted, true) & set(startTime, time($now, 'ms')))

						setif(count(state.$all = incorrect) > 0, filter($all, state.$all = incorrect).state, initial)
						setif(state != flipped and state != matched, move, move + 1)
						setif(state != matched, state, flipped)

						if(move mod 2 = 0 and symbol = firstCard, set(filter($all, state.$all = flipped).state, matched))
						if(move mod 2 = 0 and symbol != firstCard, set(filter($all, state.$all = flipped).state, incorrect))
						if(move mod 2 = 0, set(firstCard, '‚ò†Ô∏è'), set(firstCard, symbol))

						addif(count(state.$all = matched) = count($all), group(moves: move, stars: rating, time: timer), stats.attempts)
					">
					<meta property="state" mv-default="initial" />
					<span property="symbol"></span>
				</li>
			</ul>
		</section>

		<!-- Attempts statistics -->
		<table class="attempts-stats" mv-app="stats" mv-storage="local" mv-autosave mv-mode="read">
			<caption>
				Attempts Results
				<svg class="clear-results" mv-action="clear(attempts)">
					<title>Clear Results</title>
					<use xlink:href="#icon-bin" />
				</svg>
			</caption>
			<thead>
				<tr>
					<th>Attempt</th>
					<th>Moves</th>
					<th>Stars</th>
					<th>Time</th>
				</tr>
			</thead>
			<tbody mv-list="attempts" mv-initial-items="0">
				<tr mv-if="count(attempts) = 0">
					<td colspan="4">There is no attempts yet!</td>
				</tr>
				<tr mv-list-item>
					<td mv-value="$index + 1">1</td>
					<td property="moves">16</td>
					<td property="stars">3</td>
					<td property="time">00:35</td>
				</tr>
			</tbody>
		</table>
	</main>

	<footer>
		<!-- Copyright -->
		<p>¬© <time datetime="2018-10-18">2021</time> Dmitry Sharabin (made with <a href="//mavo.io">Mavo</a>)</p>
		<!-- Social Links -->
		<section class="social-links">
			<a href="https://www.facebook.com/dmitrysharabin" target="_blank" title="Follow me on Facebook">
				<svg class="social-icon">
					<use xlink:href="#icon-facebook" />
				</svg>
			</a>
			<a href="https://twitter.com/DmitrySharabin" target="_blank" title="Follow me on Twitter">
				<svg class="social-icon">
					<use xlink:href="#icon-twitter" />
				</svg>
			</a>
			<a href="https://github.com/DmitrySharabin" target="_blank" title="Fork me on Github">
				<svg class="social-icon">
					<use xlink:href="#icon-github" />
				</svg>
			</a>
			<a href="https://www.linkedin.com/in/dmitry-sharabin/" target="_blank" title="My LinkedIn">
				<svg class="social-icon">
					<use xlink:href="#icon-linkedin" />
				</svg>
			</a>
		</section>
	</footer>

	<!-- Modal window with the result of the game -->
	<div class="game-over" mv-app style="--theme-color: #[game.color]; visibility: [if(game.gameOver, visible, hidden)];">
		<svg class="checkmark">
			<use xlink:href="#icon-checkmark" />
		</svg>
		<h1 class="congrats">Congratulations! You Won!</h1>
		<p class="result"></p>
		<button class="play-again"
			mv-action="
				set(game.card.state, initial)
				set(game.themeNumber, random(0, count(game.theme) - 1))
				set(game.move, 0)
				set(game.gameStarted, false)
			">Play again!</button>
	</div>

	<!--
		Icon System
		See ‚ÄúPractical SVG‚Äù by Chris Coyier (https://abookapart.com/products/practical-svg)
		Icons source: https://icomoon.io/app/#/select
	-->
	<svg aria-hidden="true" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
		<defs>
			<symbol id="icon-reset" viewBox="0 0 32 32">
				<title>Reset Game</title>
				<path d="M27.802 5.197c-2.925-3.194-7.13-5.197-11.803-5.197-8.837 0-16 7.163-16 16h3c0-7.18 5.82-13 13-13 3.844 0 7.298 1.669 9.678 4.322l-4.678 4.678h11v-11l-4.198 4.197z"></path>
				<path d="M29 16c0 7.18-5.82 13-13 13-3.844 0-7.298-1.669-9.678-4.322l4.678-4.678h-11v11l4.197-4.197c2.925 3.194 7.13 5.197 11.803 5.197 8.837 0 16-7.163 16-16h-3z"></path>
			</symbol>
			<symbol id="icon-star" viewBox="0 0 32 32">
				<title>Star Rating</title>
				<path d="M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z"></path>
			</symbol>
			<symbol id="icon-facebook" viewBox="0 0 32 32">
				<title>Follow me on Facebook</title>
				<path d="M29 0h-26c-1.65 0-3 1.35-3 3v26c0 1.65 1.35 3 3 3h13v-14h-4v-4h4v-2c0-3.306 2.694-6 6-6h4v4h-4c-1.1 0-2 0.9-2 2v2h6l-1 4h-5v14h9c1.65 0 3-1.35 3-3v-26c0-1.65-1.35-3-3-3z"></path>
			</symbol>
			<symbol id="icon-twitter" viewBox="0 0 32 32">
				<title>Follow me on Twitter</title>
				<path d="M32 7.075c-1.175 0.525-2.444 0.875-3.769 1.031 1.356-0.813 2.394-2.1 2.887-3.631-1.269 0.75-2.675 1.3-4.169 1.594-1.2-1.275-2.906-2.069-4.794-2.069-3.625 0-6.563 2.938-6.563 6.563 0 0.512 0.056 1.012 0.169 1.494-5.456-0.275-10.294-2.888-13.531-6.862-0.563 0.969-0.887 2.1-0.887 3.3 0 2.275 1.156 4.287 2.919 5.463-1.075-0.031-2.087-0.331-2.975-0.819 0 0.025 0 0.056 0 0.081 0 3.181 2.263 5.838 5.269 6.437-0.55 0.15-1.131 0.231-1.731 0.231-0.425 0-0.831-0.044-1.237-0.119 0.838 2.606 3.263 4.506 6.131 4.563-2.25 1.762-5.075 2.813-8.156 2.813-0.531 0-1.050-0.031-1.569-0.094 2.913 1.869 6.362 2.95 10.069 2.95 12.075 0 18.681-10.006 18.681-18.681 0-0.287-0.006-0.569-0.019-0.85 1.281-0.919 2.394-2.075 3.275-3.394z"></path>
			</symbol>
			<symbol id="icon-github" viewBox="0 0 32 32">
				<title>Fork me on Github</title>
				<path d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z"></path>
			</symbol>
			<symbol id="icon-linkedin" viewBox="0 0 32 32">
				<title>My LinkedIn</title>
				<path d="M29 0h-26c-1.65 0-3 1.35-3 3v26c0 1.65 1.35 3 3 3h26c1.65 0 3-1.35 3-3v-26c0-1.65-1.35-3-3-3zM12 26h-4v-14h4v14zM10 10c-1.106 0-2-0.894-2-2s0.894-2 2-2c1.106 0 2 0.894 2 2s-0.894 2-2 2zM26 26h-4v-8c0-1.106-0.894-2-2-2s-2 0.894-2 2v8h-4v-14h4v2.481c0.825-1.131 2.087-2.481 3.5-2.481 2.488 0 4.5 2.238 4.5 5v9z"></path>
			</symbol>
			<symbol id="icon-bin" viewBox="0 0 32 32">
				<title>Clear Results</title>
				<path d="M4 10v20c0 1.1 0.9 2 2 2h18c1.1 0 2-0.9 2-2v-20h-22zM10 28h-2v-14h2v14zM14 28h-2v-14h2v14zM18 28h-2v-14h2v14zM22 28h-2v-14h2v14z"></path>
				<path d="M26.5 4h-6.5v-2.5c0-0.825-0.675-1.5-1.5-1.5h-7c-0.825 0-1.5 0.675-1.5 1.5v2.5h-6.5c-0.825 0-1.5 0.675-1.5 1.5v2.5h26v-2.5c0-0.825-0.675-1.5-1.5-1.5zM18 4h-6v-1.975h6v1.975z"></path>
			</symbol>
			<symbol id="icon-checkmark" viewBox="0 0 1000 1000">
				<title>Checkmark</title>
				<path d="M500,10C229.3,10,10,229.3,10,500c0,270.7,219.3,490,490,490s490-219.3,490-490C990,229.3,770.5,10,500,10z M500,968.5C241.4,968.5,31.5,758.6,31.5,500C31.5,241.4,241.4,31.5,500,31.5c258.6,0,468.5,209.8,468.5,468.5C968.5,758.6,758.6,968.5,500,968.5z"></path>
				<path d="M211.9,441.1l-89.2,118.3c0,0,193.3,156,257.9,266.2c0,0,214.8-355.6,466.3-512.4l-99.3-118.3c0,0-232.4,162.6-357.2,423.8C390.5,618.5,293.1,506.3,211.9,441.1z"></path>
			</symbol>
		</defs>
	</svg>
</body>
</html>
